# AcademicProgramService - CRUD and Basic Retrieval Functions

This document provides a detailed description of the static asynchronous methods within the `AcademicProgramService` class that handle basic Create, Read, Update, Delete (CRUD) operations and straightforward data retrieval for academic programs.

## Static Methods

### `static async getProgramsByUniversityId(universityId: number): Promise<AcademicProgram[]>`
- **Purpose:** Fetches all academic programs offered by a specific university.
- **Parameters:** `universityId`: `number` - The unique identifier of the university.
- **Return Type:** `Promise<AcademicProgram[]>` - A promise that resolves to an array of `AcademicProgram` objects, ordered by college name, degree level, and program name.
- **Functionality:**
    - Queries the `'academic_programs'` table in Supabase.
    - Filters programs where `university_id` matches the provided `universityId`.
    - Orders the results to provide a structured list.
    - Transforms raw Supabase data (`DatabaseAcademicProgram`) to the `AcademicProgram` interface.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    const pupPrograms = await AcademicProgramService.getProgramsByUniversityId(1);
    console.log(pupPrograms);
    ```

### `static async getProgramsGroupedByCollege(universityId: number): Promise<Record<string, AcademicProgram[]>>`
- **Purpose:** Fetches all academic programs for a specified university and organizes them into groups based on their associated `collegeName`.
- **Parameters:** `universityId`: `number` - The unique identifier of the university.
- **Return Type:** `Promise<Record<string, AcademicProgram[]>>` - A promise that resolves to an object where keys are college names (strings) and values are arrays of `AcademicProgram` objects belonging to that college.
- **Functionality:**
    - Internally calls `this.getProgramsByUniversityId(universityId)` to get all programs for the university.
    - Iterates through the fetched programs and populates a `Record` object, grouping programs under their respective `collegeName`.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    const groupedPrograms = await AcademicProgramService.getProgramsGroupedByCollege(1);
    console.log(groupedPrograms['College of Computer and Information Sciences']);
    ```

### `static async createProgram(program: Omit<AcademicProgram, 'id'>): Promise<AcademicProgram>`
- **Purpose:** Inserts a new academic program record into the database.
- **Parameters:** `program`: `Omit<AcademicProgram, 'id'>` - An `AcademicProgram` object, excluding the `id` as it will be generated by the database.
- **Return Type:** `Promise<AcademicProgram>` - A promise that resolves to the newly created `AcademicProgram` object, including its database-generated `id`.
- **Functionality:**
    - Uses `supabase.from('academic_programs').insert()` to add a new record.
    - Selects the inserted record (`.select().single()`) to return the complete program object with its new ID.
    - Transforms the result.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    const newProgram = await AcademicProgramService.createProgram({
      universityId: 1, collegeName: 'New College', programName: 'BS in New Field',
      // ... other program properties
    });
    ```

### `static async updateProgram(id: number, updates: Partial<Omit<AcademicProgram, 'id' | 'universityId'>>): Promise<AcademicProgram>`
- **Purpose:** Updates an existing academic program record in the database.
- **Parameters:**
    - `id`: `number` - The unique identifier of the program to update.
    - `updates`: `Partial<Omit<AcademicProgram, 'id' | 'universityId'>>` - An object containing the fields to update. `id` and `universityId` cannot be updated.
- **Return Type:** `Promise<AcademicProgram>` - A promise that resolves to the updated `AcademicProgram` object.
- **Functionality:**
    - Uses `supabase.from('academic_programs').update()` to modify the record matching the provided `id`.
    - Selects the updated record (`.select().single()`).
    - Transforms the result.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    const updatedProgram = await AcademicProgramService.updateProgram(101, { programName: 'Revised BS in New Field' });
    ```

### `static async deleteProgram(id: number): Promise<void>`
- **Purpose:** Deletes an academic program record from the database.
- **Parameters:** `id`: `number` - The unique identifier of the program to delete.
- **Return Type:** `Promise<void>` - A promise that resolves when the deletion is successful.
- **Functionality:**
    - Uses `supabase.from('academic_programs').delete()` to remove the record matching the provided `id`.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    await AcademicProgramService.deleteProgram(101);
    console.log('Program deleted');
    ```

### `static async getProgramCount(universityId: number): Promise<number>`
- **Purpose:** Counts the total number of academic programs associated with a specific university.
- **Parameters:** `universityId`: `number` - The unique identifier of the university.
- **Return Type:** `Promise<number>` - A promise that resolves to the count of programs (or 0 if none found or an error occurs).
- **Functionality:**
    - Queries the `'academic_programs'` table.
    - Filters by `university_id`.
    - Uses `select('*', { count: 'exact', head: true })` for an efficient count without fetching actual data.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    const pupProgramCount = await AcademicProgramService.getProgramCount(1);
    console.log(`PUP has ${pupProgramCount} programs`);
    ```

### `static async getAllPrograms(): Promise<AcademicProgram[]>`
- **Purpose:** Fetches all academic program records across all universities in the database.
- **Parameters:** None.
- **Return Type:** `Promise<AcademicProgram[]>` - A promise that resolves to an array of all `AcademicProgram` objects, ordered by program name.
- **Functionality:**
    - Queries the `'academic_programs'` table.
    - Selects all columns and orders by `program_name`.
    - Transforms the result.
    - Includes error logging and re-throws errors.
- **Usage Example:**
    ```typescript
    const allPrograms = await AcademicProgramService.getAllPrograms();
    ```
